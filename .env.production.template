# ====================================================================
# baseCamp Production Environment Configuration Template
# ====================================================================
# This file contains all environment variables needed for production deployment.
# Copy this to .env.production and update with actual values for each client.
#
# REQUIRED: Replace all placeholder values before deployment
# SECURITY: Never commit actual credentials to version control
# ====================================================================

# ====================================================================
# CLIENT CONFIGURATION (REQUIRED - Update for each client)
# ====================================================================
CLIENT_NAME=client-name                    # Unique identifier (lowercase, no spaces)
CLIENT_DOMAIN=client.yourdomain.com        # Client's domain name for SSL
BUSINESS_TYPE=automotive                   # Options: automotive, medspa, consulting, general
CLIENT_TIMEZONE=America/New_York           # Client's timezone for scheduling
CLIENT_CONTACT_EMAIL=admin@client.com      # Admin contact for this client

# ====================================================================
# AIRTABLE CRM INTEGRATION (REQUIRED - Client-specific)
# ====================================================================
AIRTABLE_API_KEY=your_client_airtable_api_key_here
AIRTABLE_BASE_ID=your_client_airtable_base_id_here
AIRTABLE_TABLE_NAME=Leads                  # Usually 'Leads' but client may customize

# ====================================================================
# DOMAIN & SSL CONFIGURATION (REQUIRED for production)
# ====================================================================
# Primary domain for this client instance
DOMAIN=${CLIENT_DOMAIN}

# SSL Certificate paths (auto-managed by Let's Encrypt scripts)
SSL_CERT_PATH=/etc/letsencrypt/live/${CLIENT_DOMAIN}/fullchain.pem
SSL_KEY_PATH=/etc/letsencrypt/live/${CLIENT_DOMAIN}/privkey.pem

# Let's Encrypt configuration
LETSENCRYPT_EMAIL=admin@yourdomain.com     # Your admin email for SSL certificates
ACME_CHALLENGE_PATH=/var/www/html/.well-known/acme-challenge

# ====================================================================
# API SECURITY & PERFORMANCE (REQUIRED)
# ====================================================================
# Generate a secure random key: openssl rand -hex 32
API_SECRET_KEY=REPLACE_WITH_SECURE_RANDOM_KEY_32_CHARS_MIN

# CORS and security headers
CORS_ORIGINS=["https://${CLIENT_DOMAIN}"]
ALLOWED_HOSTS=["${CLIENT_DOMAIN}", "api"]
SECURE_COOKIES=true
HSTS_MAX_AGE=31536000

# API Performance
UVICORN_WORKERS=2                          # Adjust based on server CPU cores
MAX_CONNECTIONS=1000
KEEPALIVE_TIMEOUT=65

# ====================================================================
# RATE LIMITING (Recommended defaults - adjust per client needs)
# ====================================================================
RATE_LIMIT_PER_MINUTE=30                   # Forms per minute per IP
RATE_LIMIT_PER_HOUR=500                    # Forms per hour per IP
RATE_LIMIT_BURST=10                        # Burst allowance

# ====================================================================
# LLM CONFIGURATION (Optimized for production)
# ====================================================================
OLLAMA_BASE_URL=http://ollama:11434
OLLAMA_MODEL=mistral:latest                # Or model preferred by client
OLLAMA_TIMEOUT=45                          # Increased for production stability
OLLAMA_RETRIES=3

# Model performance settings
OLLAMA_NUM_PARALLEL=2
OLLAMA_MAX_LOADED_MODELS=2

# ====================================================================
# LEAD PROCESSING CONFIGURATION
# ====================================================================
# Similarity detection (enhanced with contact exclusion)
LEAD_SIMILARITY_THRESHOLD=0.7              # Optimized threshold for accuracy
MAX_SIMILAR_LEADS=10
ENABLE_CONTACT_EXCLUSION=true

# Collection naming (client-specific)
CHROMA_PERSIST_DIRECTORY=/app/chroma_db
CHROMA_COLLECTION_NAME=${CLIENT_NAME}_leads
CHROMA_BATCH_SIZE=100

# ====================================================================
# BACKGROUND PROCESSING (Production optimized)
# ====================================================================
ENABLE_BACKGROUND_TASKS=true
BACKGROUND_TASK_TIMEOUT=600                # 10 minutes for complex processing
BACKGROUND_WORKER_COUNT=2

# ====================================================================
# LOGGING & MONITORING (Production settings)
# ====================================================================
LOG_LEVEL=INFO                             # Options: DEBUG, INFO, WARNING, ERROR
LOG_FORMAT=json
LOG_FILE=/app/logs/basecamp.log
LOG_ROTATION_SIZE=100MB
LOG_RETENTION_DAYS=30

# Monitoring
ENABLE_METRICS=true
METRICS_PATH=/metrics
HEALTH_CHECK_TIMEOUT=10

# ====================================================================
# CONTAINER RESOURCE LIMITS (Adjust based on VPS specs)
# ====================================================================
# Port mappings for this client (unique per client)
NGINX_HTTP_PORT=80
NGINX_HTTPS_PORT=443

# API upstream for nginx
API_UPSTREAM=api:8000

# Memory limits (adjust based on VPS capacity)
API_MEMORY_LIMIT=2G
API_MEMORY_RESERVATION=512M
OLLAMA_MEMORY_LIMIT=4G
OLLAMA_MEMORY_RESERVATION=2G
REDIS_MEMORY_LIMIT=512M

# CPU limits (adjust based on VPS capacity)
API_CPU_LIMIT=1.5
API_CPU_RESERVATION=0.5
OLLAMA_CPU_LIMIT=2.0
OLLAMA_CPU_RESERVATION=1.0

# ====================================================================
# BACKUP & MAINTENANCE (Production operational)
# ====================================================================
# Backup configuration
BACKUP_ENABLED=true
BACKUP_SCHEDULE="0 2 * * *"                # Daily at 2 AM
BACKUP_RETENTION_DAYS=30
BACKUP_S3_BUCKET=basecamp-client-backups-${CLIENT_NAME}

# Maintenance windows
MAINTENANCE_WINDOW_START="02:00"
MAINTENANCE_WINDOW_END="04:00"
MAINTENANCE_TIMEZONE=${CLIENT_TIMEZONE}

# ====================================================================
# OPTIONAL FEATURES (Enable as needed)
# ====================================================================
# Redis caching (recommended for high-volume clients)
ENABLE_REDIS_CACHE=true
REDIS_URL=redis://redis:6379/0
REDIS_TTL=3600

# Advanced analytics (future feature)
ENABLE_ANALYTICS=false
ANALYTICS_RETENTION_DAYS=90

# Webhook integrations
ENABLE_WEBHOOKS=false
WEBHOOK_SECRET_KEY=REPLACE_WITH_WEBHOOK_SECRET

# ====================================================================
# DEVELOPMENT OVERRIDES (Do not use in production)
# ====================================================================
# These should always be false/disabled in production
DEBUG=false
RELOAD_ON_CHANGE=false
ENABLE_API_DOCS=false                      # Disable Swagger UI in production
ENVIRONMENT=production

# ====================================================================
# QUICK DEPLOYMENT CHECKLIST
# ====================================================================
# Before deploying this client:
# [ ] Updated CLIENT_NAME with unique identifier
# [ ] Updated CLIENT_DOMAIN with client's domain
# [ ] Updated AIRTABLE_* credentials
# [ ] Generated secure API_SECRET_KEY
# [ ] Updated LETSENCRYPT_EMAIL
# [ ] Reviewed resource limits for VPS capacity
# [ ] Validated CORS_ORIGINS for client's domain
# [ ] Confirmed BUSINESS_TYPE matches client's industry
# ====================================================================